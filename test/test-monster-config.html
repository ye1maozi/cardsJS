<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Monsteré…ç½®åŠŸèƒ½æµ‹è¯•</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            background-color: #f5f5f5;
        }
        .test-container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .test-section {
            margin-bottom: 30px;
            padding: 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        .test-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        .test-button {
            background: #007bff;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            margin: 5px;
        }
        .test-button:hover {
            background: #0056b3;
        }
        .test-button.danger {
            background: #dc3545;
        }
        .test-button.danger:hover {
            background: #c82333;
        }
        .test-button.success {
            background: #28a745;
        }
        .test-button.success:hover {
            background: #218838;
        }
        .test-result {
            margin: 10px 0;
            padding: 10px;
            border-radius: 5px;
        }
        .test-result.success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .test-result.error {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .test-result.info {
            background: #d1ecf1;
            color: #0c5460;
            border: 1px solid #bee5eb;
        }
        .monster-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }
        .monster-card {
            border: 1px solid #ddd;
            border-radius: 8px;
            padding: 15px;
            background: #f8f9fa;
        }
        .monster-name {
            font-size: 16px;
            font-weight: bold;
            color: #333;
            margin-bottom: 5px;
        }
        .monster-class {
            color: #666;
            font-size: 14px;
            margin-bottom: 5px;
        }
        .monster-difficulty {
            display: inline-block;
            padding: 2px 8px;
            border-radius: 12px;
            font-size: 12px;
            font-weight: bold;
            margin-bottom: 5px;
        }
        .difficulty-1 { background: #28a745; color: white; }
        .difficulty-2 { background: #ffc107; color: black; }
        .difficulty-3 { background: #dc3545; color: white; }
        .monster-stats {
            font-size: 12px;
            color: #666;
            margin-bottom: 5px;
        }
        .monster-cards {
            font-size: 12px;
            color: #666;
        }
        .preferred-cards {
            color: #28a745;
        }
        .avoid-cards {
            color: #dc3545;
        }
        .iframe-container {
            margin-top: 20px;
            border: 2px solid #007bff;
            border-radius: 10px;
            overflow: hidden;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1>ğŸ‰ Monsteré…ç½®åŠŸèƒ½æµ‹è¯•</h1>
        <p>æµ‹è¯•monsteré…ç½®ç³»ç»Ÿï¼ŒåŒ…æ‹¬monsteré€‰æ‹©ã€å±æ€§é…ç½®ã€å¡ç‰Œåå¥½ç­‰åŠŸèƒ½ã€‚</p>

        <div class="test-section">
            <div class="test-title">1. Monsteré…ç½®åŠ è½½æµ‹è¯•</div>
            <p>æµ‹è¯•monsteré…ç½®æ˜¯å¦æ­£ç¡®åŠ è½½ã€‚</p>
            <button class="test-button" onclick="testMonsterConfigLoading()">æµ‹è¯•é…ç½®åŠ è½½</button>
            <button class="test-button" onclick="displayAllMonsters()">æ˜¾ç¤ºæ‰€æœ‰Monster</button>
            <div id="config-results"></div>
        </div>

        <div class="test-section">
            <div class="test-title">2. Monsteré€‰æ‹©æµ‹è¯•</div>
            <p>æµ‹è¯•ä¸åŒçš„monsteré€‰æ‹©é€»è¾‘ã€‚</p>
            <button class="test-button" onclick="testRandomMonster()">éšæœºé€‰æ‹©Monster</button>
            <button class="test-button" onclick="testDifficultySelection()">æŒ‰éš¾åº¦é€‰æ‹©</button>
            <button class="test-button" onclick="testClassSelection()">æŒ‰èŒä¸šé€‰æ‹©</button>
            <div id="selection-results"></div>
        </div>

        <div class="test-section">
            <div class="test-title">3. Monsterå±æ€§æµ‹è¯•</div>
            <p>æµ‹è¯•monsterå±æ€§é…ç½®æ˜¯å¦æ­£ç¡®åº”ç”¨ã€‚</p>
            <button class="test-button" onclick="testMonsterAttributes()">æµ‹è¯•å±æ€§é…ç½®</button>
            <button class="test-button" onclick="testCharacterCreation()">æµ‹è¯•è§’è‰²åˆ›å»º</button>
            <div id="attributes-results"></div>
        </div>

        <div class="test-section">
            <div class="test-title">4. Monsterå¡ç‰Œåå¥½æµ‹è¯•</div>
            <p>æµ‹è¯•monsterçš„å¡ç‰Œåå¥½å’Œé¿å…é€»è¾‘ã€‚</p>
            <button class="test-button" onclick="testCardPreferences()">æµ‹è¯•å¡ç‰Œåå¥½</button>
            <button class="test-button" onclick="testDeckBuilding()">æµ‹è¯•ç‰Œç»„æ„å»º</button>
            <div id="cards-results"></div>
        </div>

        <div class="test-section">
            <div class="test-title">5. AIç­–ç•¥æµ‹è¯•</div>
            <p>æµ‹è¯•monsterçš„AIç­–ç•¥å’Œä¸ªæ€§ç‰¹å¾ã€‚</p>
            <button class="test-button" onclick="testAIStrategy()">æµ‹è¯•AIç­–ç•¥</button>
            <button class="test-button" onclick="testPersonality()">æµ‹è¯•ä¸ªæ€§ç‰¹å¾</button>
            <div id="ai-results"></div>
        </div>

        <div class="test-section">
            <div class="test-title">6. æ¸¸æˆé›†æˆæµ‹è¯•</div>
            <p>åœ¨ä¸‹æ–¹æ¸¸æˆç•Œé¢ä¸­æµ‹è¯•å®Œæ•´çš„monsteré…ç½®åŠŸèƒ½ã€‚</p>
            <button class="test-button success" onclick="testGameIntegration()">æµ‹è¯•æ¸¸æˆé›†æˆ</button>
            <div id="integration-results"></div>
        </div>

        <div class="iframe-container">
            <iframe src="../index.html" style="width: 100%; height: 600px; border: none;"></iframe>
        </div>
    </div>

    <!-- å¼•å…¥é…ç½®æ•°æ®æ–‡ä»¶ -->
    <script src="../js/ConfigData.js"></script>
    
    <script>
        let monsters = [];

        // åŠ¨æ€åŠ è½½è„šæœ¬
        async function loadScript(src) {
            return new Promise((resolve, reject) => {
                const existingScript = document.querySelector(`script[src="${src}"]`);
                if (existingScript) {
                    resolve();
                    return;
                }
                
                const script = document.createElement('script');
                script.src = src;
                script.onload = resolve;
                script.onerror = reject;
                document.head.appendChild(script);
            });
        }

        // åˆå§‹åŒ–æµ‹è¯•ç¯å¢ƒ
        async function initializeTest() {
            try {
                // åŠ è½½å¿…è¦çš„è„šæœ¬
                await loadScript('../js/ConfigManager.js');
                await loadScript('../js/MonsterConfigManager.js');

                // åŠ è½½é…ç½®
                await ConfigManager.loadAllConfigs();
                await MonsterConfigManager.loadMonsterConfigs();

                // è·å–æ‰€æœ‰monsteré…ç½®
                monsters = ConfigManager.getAllMonsterConfigs();

                addConfigResult('âœ… æµ‹è¯•ç¯å¢ƒåˆå§‹åŒ–å®Œæˆ', 'success');
                addConfigResult(`åŠ è½½äº† ${monsters.length} ä¸ªmonsteré…ç½®`);

            } catch (error) {
                addConfigResult(`âŒ åˆå§‹åŒ–å¤±è´¥: ${error.message}`, 'error');
            }
        }

        function addConfigResult(message, type = 'info') {
            const container = document.getElementById('config-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function addSelectionResult(message, type = 'info') {
            const container = document.getElementById('selection-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function addAttributesResult(message, type = 'info') {
            const container = document.getElementById('attributes-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function addCardsResult(message, type = 'info') {
            const container = document.getElementById('cards-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function addAIResult(message, type = 'info') {
            const container = document.getElementById('ai-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function addIntegrationResult(message, type = 'info') {
            const container = document.getElementById('integration-results');
            const resultDiv = document.createElement('div');
            resultDiv.className = `test-result ${type}`;
            resultDiv.textContent = message;
            container.appendChild(resultDiv);
        }

        function testMonsterConfigLoading() {
            document.getElementById('config-results').innerHTML = '';
            addConfigResult('ğŸ” Monsteré…ç½®åŠ è½½æµ‹è¯•ï¼š');
            addConfigResult(`æ€»monsteræ•°é‡: ${monsters.length}`);
            
            if (monsters.length > 0) {
                addConfigResult('âœ… Monsteré…ç½®åŠ è½½æˆåŠŸ', 'success');
                monsters.forEach(monster => {
                    addConfigResult(`â€¢ ${monster.name} (${monster.class}) - éš¾åº¦${monster.difficulty}`);
                });
            } else {
                addConfigResult('âŒ æ²¡æœ‰æ‰¾åˆ°monsteré…ç½®', 'error');
            }
        }

        function displayAllMonsters() {
            document.getElementById('config-results').innerHTML = '';
            addConfigResult('ğŸ“‹ æ‰€æœ‰Monsteré…ç½®ï¼š');
            
            const monsterGrid = document.createElement('div');
            monsterGrid.className = 'monster-grid';
            
            monsters.forEach(monster => {
                const monsterCard = document.createElement('div');
                monsterCard.className = 'monster-card';
                monsterCard.innerHTML = `
                    <div class="monster-name">${monster.name}</div>
                    <div class="monster-class">${monster.class}</div>
                    <div class="monster-difficulty difficulty-${monster.difficulty}">éš¾åº¦ ${monster.difficulty}</div>
                    <div class="monster-stats">
                        ç”Ÿå‘½: ${monster.maxHealth} | èƒ½é‡: ${monster.maxEnergy} | åˆå§‹èƒ½é‡: ${monster.initialEnergy}
                    </div>
                    <div class="monster-stats">
                        åŠ›é‡: ${monster.strength} | æ•æ·: ${monster.agility} | ç²¾ç¥: ${monster.spirit}
                    </div>
                    <div class="monster-cards">
                        <div class="preferred-cards">åå¥½: ${monster.preferredCards.join(', ')}</div>
                        <div class="avoid-cards">é¿å…: ${monster.avoidCards.join(', ') || 'æ— '}</div>
                    </div>
                `;
                monsterGrid.appendChild(monsterCard);
            });
            
            document.getElementById('config-results').appendChild(monsterGrid);
        }

        function testRandomMonster() {
            document.getElementById('selection-results').innerHTML = '';
            addSelectionResult('ğŸ² éšæœºMonsteré€‰æ‹©æµ‹è¯•ï¼š');
            
            for (let i = 0; i < 5; i++) {
                const randomMonster = ConfigManager.getRandomMonster();
                addSelectionResult(`éšæœºé€‰æ‹© ${i + 1}: ${randomMonster.name} (${randomMonster.class})`);
            }
        }

        function testDifficultySelection() {
            document.getElementById('selection-results').innerHTML = '';
            addSelectionResult('ğŸ“Š æŒ‰éš¾åº¦é€‰æ‹©æµ‹è¯•ï¼š');
            
            for (let difficulty = 1; difficulty <= 3; difficulty++) {
                const difficultyMonsters = ConfigManager.getMonstersByDifficulty(difficulty);
                addSelectionResult(`éš¾åº¦ ${difficulty}: ${difficultyMonsters.length} ä¸ªmonster`);
                difficultyMonsters.forEach(monster => {
                    addSelectionResult(`  â€¢ ${monster.name} (${monster.class})`);
                });
            }
        }

        function testClassSelection() {
            document.getElementById('selection-results').innerHTML = '';
            addSelectionResult('âš”ï¸ æŒ‰èŒä¸šé€‰æ‹©æµ‹è¯•ï¼š');
            
            const classes = ['æˆ˜å£«', 'æ³•å¸ˆ', 'ç›—è´¼', 'ç‰§å¸ˆ'];
            classes.forEach(characterClass => {
                const classMonsters = ConfigManager.getMonstersByClass(characterClass);
                addSelectionResult(`${characterClass}: ${classMonsters.length} ä¸ªmonster`);
                classMonsters.forEach(monster => {
                    addSelectionResult(`  â€¢ ${monster.name} (éš¾åº¦${monster.difficulty})`);
                });
            });
        }

        function testMonsterAttributes() {
            document.getElementById('attributes-results').innerHTML = '';
            addAttributesResult('ğŸ“ˆ Monsterå±æ€§æµ‹è¯•ï¼š');
            
            const testMonster = monsters[0];
            if (testMonster) {
                addAttributesResult(`æµ‹è¯•monster: ${testMonster.name}`);
                addAttributesResult(`ç”Ÿå‘½å€¼: ${testMonster.maxHealth}`);
                addAttributesResult(`èƒ½é‡: ${testMonster.maxEnergy} (åˆå§‹: ${testMonster.initialEnergy})`);
                addAttributesResult(`å±æ€§: åŠ›é‡${testMonster.strength} æ•æ·${testMonster.agility} ç²¾ç¥${testMonster.spirit}`);
                addAttributesResult(`æ¢å¤: ç”Ÿå‘½${testMonster.healthRegenRate}/s èƒ½é‡${testMonster.energyRegenRate}/s`);
                addAttributesResult('âœ… å±æ€§é…ç½®æ­£ç¡®', 'success');
            }
        }

        function testCharacterCreation() {
            document.getElementById('attributes-results').innerHTML = '';
            addAttributesResult('ğŸ‘¤ è§’è‰²åˆ›å»ºæµ‹è¯•ï¼š');
            
            const testMonster = monsters[0];
            if (testMonster) {
                const characterConfig = MonsterConfigManager.createCharacterFromMonster(testMonster);
                addAttributesResult(`ä»monsteråˆ›å»ºè§’è‰²: ${testMonster.name}`);
                addAttributesResult(`èŒä¸š: ${characterConfig.class}`);
                addAttributesResult(`å±æ€§: ç”Ÿå‘½${characterConfig.maxHealth} èƒ½é‡${characterConfig.maxEnergy}`);
                addAttributesResult('âœ… è§’è‰²åˆ›å»ºæˆåŠŸ', 'success');
            }
        }

        function testCardPreferences() {
            document.getElementById('cards-results').innerHTML = '';
            addCardsResult('ğŸƒ å¡ç‰Œåå¥½æµ‹è¯•ï¼š');
            
            monsters.forEach(monster => {
                const preferredCards = MonsterConfigManager.getPreferredCards(monster);
                const avoidCards = MonsterConfigManager.getAvoidCards(monster);
                addCardsResult(`${monster.name}:`);
                addCardsResult(`  åå¥½: ${preferredCards.join(', ') || 'æ— '}`);
                addCardsResult(`  é¿å…: ${avoidCards.join(', ') || 'æ— '}`);
            });
        }

        function testDeckBuilding() {
            document.getElementById('cards-results').innerHTML = '';
            addCardsResult('ğŸ´ ç‰Œç»„æ„å»ºæµ‹è¯•ï¼š');
            
            const testMonster = monsters.find(m => m.preferredCards.length > 0);
            if (testMonster) {
                addCardsResult(`æµ‹è¯•monster: ${testMonster.name}`);
                addCardsResult(`åå¥½å¡ç‰Œ: ${testMonster.preferredCards.join(', ')}`);
                addCardsResult(`é¿å…å¡ç‰Œ: ${testMonster.avoidCards.join(', ') || 'æ— '}`);
                addCardsResult('âœ… ç‰Œç»„æ„å»ºé€»è¾‘æ­£ç¡®', 'success');
            }
        }

        function testAIStrategy() {
            document.getElementById('ai-results').innerHTML = '';
            addAIResult('ğŸ¤– AIç­–ç•¥æµ‹è¯•ï¼š');
            
            monsters.forEach(monster => {
                const strategy = MonsterConfigManager.getAIStrategy(monster);
                const personality = MonsterConfigManager.getPersonality(monster);
                addAIResult(`${monster.name}:`);
                addAIResult(`  ç­–ç•¥: ${strategy}`);
                addAIResult(`  æ€§æ ¼: ${personality}`);
            });
        }

        function testPersonality() {
            document.getElementById('ai-results').innerHTML = '';
            addAIResult('ğŸ§  ä¸ªæ€§ç‰¹å¾æµ‹è¯•ï¼š');
            
            const testMonster = monsters[0];
            if (testMonster) {
                addAIResult(`æµ‹è¯•monster: ${testMonster.name}`);
                addAIResult(`æ€§æ ¼: ${testMonster.personality}`);
                addAIResult(`ç­–ç•¥: ${testMonster.aiStrategy}`);
                addAIResult('âœ… ä¸ªæ€§ç‰¹å¾é…ç½®æ­£ç¡®', 'success');
            }
        }

        function testGameIntegration() {
            document.getElementById('integration-results').innerHTML = '';
            addIntegrationResult('ğŸ® æ¸¸æˆé›†æˆæµ‹è¯•ï¼š');
            addIntegrationResult('1. åœ¨ä¸‹æ–¹æ¸¸æˆç•Œé¢ä¸­ç‚¹å‡»"å¼€å§‹æ¸¸æˆ"');
            addIntegrationResult('2. è§‚å¯Ÿæ§åˆ¶å°æ—¥å¿—ä¸­çš„monsteré€‰æ‹©ä¿¡æ¯');
            addIntegrationResult('3. æ£€æŸ¥ç”µè„‘è§’è‰²çš„å±æ€§å’Œç‰Œç»„');
            addIntegrationResult('4. è§‚å¯ŸAIçš„è¡Œä¸ºæ˜¯å¦ç¬¦åˆmonsteré…ç½®');
            addIntegrationResult('âœ… è¯·åœ¨ä¸‹æ–¹æ¸¸æˆç•Œé¢ä¸­éªŒè¯å®Œæ•´åŠŸèƒ½', 'success');
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–æµ‹è¯•
        window.addEventListener('load', function() {
            initializeTest();
        });
    </script>
</body>
</html> 